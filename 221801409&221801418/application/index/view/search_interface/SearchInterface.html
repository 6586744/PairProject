<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>创建用户</title>
    <style>
      @import url("//unpkg.com/element-ui@2.15.1/lib/theme-chalk/index.css");
      .demo-table-expand {
        font-size: 0;
      }
      .demo-table-expand label {
        width: 90px;
        color: #99a9bf;
      }
      .demo-table-expand .el-form-item {
        margin-right: 0;
        margin-bottom: 0;
        width: 50%;
      }
    </style>
    <script src="http://unpkg.com/vue/dist/vue.js"></script>
    <script src="http://unpkg.com/element-ui@2.15.1/lib/index.js"></script>
</head>
<body>
<div class="uplan" style="width:100%;height:40px ;border:0px;background-color: rgb(107, 107, 209);">
  <div style="color: white;font-size: 25px;">论文查询系统</div>
</div>
<div id="app">
  <div style="width:50%;margin:15px auto">
    <el-input placeholder="请输入搜索内容" v-model="input3" class="input-with-select" >
      <!--<el-select v-model="select" slot="prepend" placeholder="请选择" style="width: 130px">
        <el-option label="按标题搜索" value="1"></el-option>
        <el-option label="按关键词搜索" value="2"></el-option>
        <el-option label="按摘要搜索" value="3"></el-option>
      </el-select>-->
      <el-button slot="append" icon="el-icon-search"></el-button>
    </el-input>
  </div>
<template>
  <el-table
    :data="tableData.slice((currentPage-1)*pageSize,currentPage*pageSize)" border
    style="width: 80%;margin-top: 15px;">
    <el-table-column type="expand">
      <template slot-scope="props">
        <el-form label-position="left" inline class="demo-table-expand">
          <el-form-item label="论文标题">
            <span>{{ props.row.title }}</span>
          </el-form-item>
          <el-form-item label="关键词">
            <span>{{ props.row.keyword }}</span>
          </el-form-item>
          <el-form-item label="摘要">
            <span>{{ props.row.abstract }}</span>
          </el-form-item>
          <el-form-item label="发布日期">
            <span>{{ props.row.releasetime }}</span>
        </el-form>
      </template>
    </el-table-column>
    <el-table-column
      min-width="5"
      align="center"
      label="标题"
      prop="title">
    </el-table-column>
    <el-table-column
      min-width="5"
      align="center"
      label="关键词"
      prop="keyword">
    </el-table-column>
    <el-table-column
      min-width="5"
      align="center"
      label="摘要"
      show-overflow-tooltip
      prop="abstract">
    </el-table-column>
    <el-table-column label="操作" min-width="3" align="center">
      <template slot-scope="scope">
        <el-button
          size="mini"
          @click="handleEdit(scope.$index, scope.row)">收藏</el-button>
        <el-button
          size="mini"
          @click="handleDelete(scope.$index, scope.row)">查看</el-button>
      </template>
    </el-table-column>
  </el-table>
  <el-pagination
    style="text-align: center;"
    @current-change="pageChange"
    :page-size="pageSize"
    layout="total, prev, pager, next, jumper"
    :total="tableData.length">
</el-pagination>
</template>
</div>
<script>
var fromDb={$try|raw};
var DDB=[];
var Main = {
  mounted(){
            var that=this;
            var list = {};
                $.ajax({
                    //请求方式
                    type : "get",
                    //请求的媒体类型
                    contentType: "application/json;charset=UTF-8",
                    //请求地址
                    url : "Serchinterface.php",
                    //数据，json字符串
                    data : JSON.stringify(list),
                    //请求成功
                    success : function(result) {
                        console.log(result);
                        for(var i in result){
                            that.tableData.push(result[i]);
                            
                        }console.log(that.tableData);
                    },
                    //请求失败，包含具体的错误信息
                    error : function(e){
                        console.log(e.status);
                        console.log(e.responseText);
                    }
                });
        },
  data() {
    return {
      input3:'',
      select: '1',
      currentPage: 1,
      pageSize: 7,
      db:DDB,
    }
    /*watch: {
	    select:function(val,oldVal){
		  this.tableData = this.fromDb.filter( item => (~item.name.indexOf(val)));  
	    }
    } */
  },
  methods:{
    pageChange(val) {
      this.currentPage = val;
    },
  },
  computed:{
    tableData() {
                const select = this.select
                if(select) {
                    // filter() 方法创建一个新的数组，新数组中的元素是通过检查指定数组中符合条件的所有元素。
                    // 注意： filter() 不会对空数组进行检测。
                    // 注意： filter() 不会改变原始数组。
                    return this.db.filter(data => {
                        // some() 方法用于检测数组中的元素是否满足指定条件;
                        // some() 方法会依次执行数组的每个元素：
                        // 如果有一个元素满足条件，则表达式返回true , 剩余的元素不会再执行检测;
                        // 如果没有满足条件的元素，则返回false。
                        // 注意： some() 不会对空数组进行检测。
                        // 注意： some() 不会改变原始数组。
                        return Object.keys(data).some(key => {
                            // indexOf() 返回某个指定的字符在某个字符串中首次出现的位置，如果没有找到就返回-1；
                            // 该方法对大小写敏感！所以之前需要toLowerCase()方法将所有查询到内容变为小写。
                            return String(data[key]).toLowerCase().indexOf(select) > -1
                        })
                    })
                }
                return this.db
            }
  }
}
var Ctor = Vue.extend(Main)
new Ctor().$mount('#app')
</script>
</body>
</html>